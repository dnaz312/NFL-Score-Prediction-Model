filenames = glob.glob('data_2019/\*.csv') li = [] for filename in filenames: df = pd.read_csv(filename, index_col=None, header=0) filename = filename.replace('data_2019/', "") filename = filename.replace('.csv', '') df'Day' = filename df.rename(columns= {'Day' : 'Team Name'}, inplace= True) df'Week' = range(1, len(df) + 1) li.append(df)

team_stats_init = pd.concat(li, axis= 0, ignore_index=True)

team_stats_init.drop(team_stats_init.columnsteam_stats_init.columns.str.contains('unnamed',case = False),axis = 1, inplace = True) team_stats_init.drop(team_stats_init.columnsteam_stats_init.columns.str.contains('opp',case = False),axis = 1, inplace = True)

team_stats_init = team_stats_init.rename(columns = {team_stats_init.columns5: "ScoredPoints", team_stats_init.columns6: "FirstDowns", team_stats_init.columns10: "TurnoversAllowed",team_stats_init.columns11 : "FirstAllowed", team_stats_init.columns12 : "YardsAllowed", team_stats_init.columns12: "YardsAllowed", team_stats_init.columns13: "PassYardsAllowed", team_stats_init.columns14: "RushingYardsAllowed", team_stats_init.columns15: "Turnovers"}) team_stats_init.drop(team_stats_init.columnsteam_stats_init.columns.str.contains('Date',case = False),axis = 1, inplace = True) team_stats_init.drop(team_stats_init.columnsteam_stats_init.columns.str.contains('Rec',case = False),axis = 1, inplace = True) team_stats_init.drop(team_stats_init.columnsteam_stats_init.columns.str.contains('OT',case = False),axis = 1, inplace = True) team_stats_init = team_stats_init.iloc:, :12 team_stats_init.to_csv(r"data_for_models/full_dataframe.csv") team_stats_init.head(34)
